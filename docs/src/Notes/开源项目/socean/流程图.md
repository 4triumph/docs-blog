
```mermaid
graph TD
    A[用户上传图像] -->|图像数据| B[图像预处理]
    B --> C[数据增强]
    C --> D[CNN模型推理]
    D --> E[与数据库匹配]
    E --> F[生成识别结果]
    F --> G[结果展示界面]
    G --> H[用户界面]

    subgraph 后端服务
        I[Flask应用]
        I -->|处理请求| B
        I -->|发送结果| F
    end

    subgraph CNN模型
        D1[卷积层]
        D2[池化层]
        D3[全连接层]
        D --> D1
        D1 --> D2
        D2 --> D3
        D3 --> E
    end
```

```mermaid
graph TD
    A[用户请求] --> B[前端界面]
    B --> C[发送API请求]
    C --> D[后端API]
    D --> E[数据库查询]
    E --> F[处理数据]
    F --> G[返回JSON数据]
    G --> H[前端接收数据]
    H --> I[Cesium加载3D地球]
    H --> J[ECharts展示图表]
    I --> K[标记海洋站点和监测点]
    J --> L[展示水质参数统计]
    K --> M[用户交互]
    L --> M
    M --> N[查看详细信息或切换视图]

    subgraph 前端
        B
        C
        H
        I
        J
        K
        L
        M
    end

    subgraph 后端
        D
        E
        F
        G
    end

    subgraph 数据库
        E
    end
```




```mermaid
graph TD
    A(用户上传图像) --> B(图像预处理)
    B --> C(数据增强)
    C --> D(CNN模型推理)
    D --> E(与数据库匹配)
    E --> F(生成识别结果)
    F --> G(结果展示界面)
    G --> H(用户界面)

    subgraph 后端服务
        I(Flask应用)
        I -->|处理请求| B
        I -->|发送结果| F
    end

    subgraph CNN模型
        D1(卷积层)
        D2(池化层)
        D3(全连接层)
        D --> D1
        D1 --> D2
        D2 --> D3
        D3 --> E
    end
```


```mermaid
sequenceDiagram
    participant Browser
    participant Frontend
    participant Controller
    participant Service
    participant Database
    
    %% 初始化前端
    Browser->>Frontend: 1. 加载页面
    Frontend->>Frontend: 2. 初始化ECharts/Cesium
    
    %% 数据请求流程
    Frontend->>Controller: 3. HTTP请求数据
    Controller->>Service: 4. 调用服务层
    Service->>Database: 5. SQL查询
    Database-->>Service: 6. 返回数据
    Service-->>Controller: 7. 处理数据
    Controller-->>Frontend: 8. 返回JSON数据
    
    %% 数据可视化
    Frontend->>Frontend: 9. 数据格式转换
    
    par ECharts展示
        Frontend->>Browser: 10a. 更新ECharts图表
    and Cesium展示
        Frontend->>Browser: 10b. 更新Cesium地图
    end

```

```mermaid
flowchart TB
    subgraph Frontend["前端层"]
        B[Browser]
        E[ECharts组件]
        C[Cesium组件]
        B --> E
        B --> C
    end
    
    subgraph Backend["后端层"]
        CO[Controller控制器]
        SE[Service服务层]
        CO --> SE
    end
    
    subgraph DB["数据层"]
        DA[(Database)]
    end
    
    %% 数据流向
    E <-.JSON数据.-> CO
    C <-.JSON数据.-> CO
    SE <--> DA
    
    %% 数据更新方式
    subgraph UpdateMethods["数据更新方式"]
        T[定时刷新]
        W[WebSocket推送]
        U[用户交互触发]
    end
    
    UpdateMethods --> Frontend
```


```mermaid
sequenceDiagram
    participant Browser
    participant Frontend
    participant Controller
    participant Service
    participant Database
    
    %% 初始化前端
    Browser->>+Frontend: 1. 加载页面
    Frontend->>+Frontend: 2. 初始化ECharts/Cesium
    deactivate Frontend
    
    %% 数据请求流程
    Frontend->>+Controller: 3. HTTP请求数据
    Note right of Frontend: GET /api/data
    Controller->>+Service: 4. 调用服务层
    Service->>+Database: 5. SQL查询
    Database-->>-Service: 6. 返回数据
    Service-->>-Controller: 7. 处理数据
    Controller-->>-Frontend: 8. 返回JSON数据
    
    %% 数据可视化
    Frontend->>Frontend: 9. 数据格式转换
    
    par ECharts展示
        Frontend->>Browser: 10a. 更新ECharts图表
        Note left of Frontend: 更新图表数据
    and Cesium展示
        Frontend->>Browser: 10b. 更新Cesium地图
        Note left of Frontend: 更新地图数据
    end
    deactivate Frontend
```


```mermaid
flowchart TB
    subgraph Init["Cesium初始化"]
        A[开始] --> B[初始化Cesium Viewer]
        B --> C[配置地图参数]
        C --> D[设置相机视角]
        D --> E[加载地形数据]
    end

    subgraph DataLoading["数据加载"]
        F{数据来源} -->|动态数据| G1[后端API请求]
        F -->|静态数据| G2[本地文件]
        
        G1 --> H1[生物分布数据]
        G1 --> H2[海洋环境数据]
        G2 --> H3[风场数据]
        G2 --> H4[地形数据]
        
        H1 --> I1[珊瑚分布]
        H1 --> I2[海绵分布]
        H2 --> I3[温度]
        H2 --> I4[盐度]
        H2 --> I5[溶解氧]
        H3 --> I6[风场]
        H3 --> I7[洋流]
        
        I1 & I2 --> J1[位置数据转换]
        I3 & I4 & I5 --> J2[环境数据处理]
        I6 & I7 --> J3[矢量场处理]
    end

    subgraph Visualization["可视化展示"]
        K[创建Entity] --> L{展示类型}
        L -->|生物分布| M1[点位标记]
        L -->|环境数据| M2[色彩图层]
        L -->|矢量场| M3[粒子系统]
        
        M1 --> N1[分类展示]
        N1 --> O1[珊瑚标记]
        N1 --> O2[海绵标记]
        
        M2 --> N2[渐变色映射]
        N2 --> O3[温度图层]
        N2 --> O4[盐度图层]
        N2 --> O5[溶解氧图层]
        
        M3 --> N3[动态展示]
        N3 --> O6[风场动画]
        N3 --> O7[洋流动画]
        
        O1 & O2 & O3 & O4 & O5 & O6 & O7 --> P[场景渲染]
    end

    subgraph Interaction["交互控制"]
        Q[用户交互] --> R{交互类型}
        R -->|图层控制| S1[切换显示]
        R -->|数据查询| S2[属性查看]
        R -->|时间控制| S3[动态更新]
        S1 & S2 & S3 --> T[更新场景]
    end

    %% 流程连接
    Init --> DataLoading
    DataLoading --> Visualization
    Visualization --> Interaction
    T -.->|状态更新| K

    %% 样式定义
    classDef initStyle fill:#e1f5fe,stroke:#01579b,stroke-width:2px;
    classDef dataStyle fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px;
    classDef visualStyle fill:#fff3e0,stroke:#ef6c00,stroke-width:2px;
    classDef interactStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px;

    class A,B,C,D,E initStyle;
    class F,G1,G2,H1,H2,H3,H4,I1,I2,I3,I4,I5,I6,I7,J1,J2,J3 dataStyle;
    class K,L,M1,M2,M3,N1,N2,N3,O1,O2,O3,O4,O5,O6,O7,P visualStyle;
    class Q,R,S1,S2,S3,T interactStyle;
```